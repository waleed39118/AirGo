{% extends 'base.html' %}
{% load static %}

{% block content %}
<h2 class="text-center mb-4">Plan Your Dream Trip</h2>

<form method="GET" action="{% url 'search' %}" class="bg-light p-4 rounded shadow mb-5">
  <div class="row g-3 align-items-end">

    <div class="col-md-2">
      <label class="form-label">Search by</label>
      <select class="form-select" name="search_type" required>
        <option value="flights">Flights</option>
        <option value="destinations">Destinations</option>
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">From Country</label>
      <select class="form-select" name="from_destination" required>
        {% for dest in destinations %}
          <option value="{{ dest.id }}">{{ dest.city_name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">To Country</label>
      <select class="form-select" name="to_destination" required>
        {% for dest in destinations %}
          <option value="{{ dest.id }}">{{ dest.city_name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-2">
      <label class="form-label">Location</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
        <input type="text" class="form-control" name="location" placeholder="City or Country" required>
      </div>
    </div>

    <div class="col-md-2">
      <label class="form-label">Start Date</label>
      <input type="date" class="form-control" name="start_date" required>
    </div>

    <div class="col-md-2">
      <label class="form-label">End Date</label>
      <input type="date" class="form-control" name="end_date" required>
    </div>

    <div class="col-md-2 d-flex align-items-end">
      <button type="submit" class="btn btn-primary w-100">
        <i class="fas fa-search"></i> Search
      </button>
    </div>
  </div>
</form>


<div class="row g-4">
  {% for flight in flights %}
  <div class="col-md-4">
    <div class="card h-100 shadow-sm">
      <div class="card-body d-flex flex-column">
        <h5>{{ flight.flight_number }}</h5>
        <p class="mb-1"><i class="fas fa-plane-departure"></i> From: {{ flight.origin.city_name }}</p>
        <p class="mb-1"><i class="fas fa-plane-arrival"></i> To: {{ flight.destination.city_name }}</p>
        <p class="mb-1"><i class="fas fa-calendar-alt"></i> When: {{ flight.departure_time }}</p>
        <p class="mb-1"><i class="fas fa-clock"></i> Duration: {{ flight.arrival_time|time:"H:i" }}</p>
        <p class="mt-auto fw-bold">Price: ${{ flight.price }}</p>
        <a href="{% url 'book_flight' flight.id %}" class="btn btn-outline-primary mt-3">Book Now</a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}